heart <- read.csv("heart.csv",sep=",")
SUMMARY(HEART)
summary(heart)
heart <- read.csv("heart.csv",sep=",")
str(heart)
heart$Age <- as.numeric(heart$Age)
str(heart)
heart$Age <- as.numeric(heart$Age)
heart$Sex <- as.factor(heart$Sex)
heart$ChestPainType <- as.factor(heart$ChestPainType)
heart$RestingBP <- as.numeric(heart$RestingBP)
heart$Cholesterol <- as.numeric(heart$Cholesterol)
heart$FastingBS <- as.numeric(heart$FastingBS)
heart$RestingECG  <- as.factor(heart$RestingECG)
heart$MaxHR <- as.numeric(heart$MaxHR)
heart$ExerciseAngina <- as.factor(heart$ExerciseAngina)
heart$ST_Slope <- as.factor(heart$ST_Slope)
heart$HeartDisease <- as.numeric(heart$HeartDisease)
str(heart)
summary(heart)
is.na(heart$MaxHR)
is.na(heart$MaxHR) == TRUW
is.na(heart$MaxHR) == TRUE
Age_nor <- (heart$Age-min(heart$Age))/(max(heart$Age)-min(heart$Age))
cbind(heart,Age_nor)
heart <- cbind(heart,Age_nor)
heart
Age_nor <- (2*(heart$Age-min(heart$Age))/(max(heart$Age)-min(heart$Age)))-1
heart <- cbind(heart,Age_nor)
heart
heart <- read.csv("heart.csv",sep=",")
Age_nor <- (2*(heart$Age-min(heart$Age))/(max(heart$Age)-min(heart$Age)))-1
heart <- cbind(heart,Age_nor)
heart
min(heart$Age_nor)
max(heart$Age_nor)
summary(heart)
cut(heart$Age, breaks = c(0,40,60,80), labels = c("[0-40)","[40,60)","[60,80]"))
heart <- cbind(heart,Age_dist)
Age_dist <- cut(heart$Age, breaks = c(0,40,60,80), labels = c("[0-40)","[40,60)","[60,80]"))
heart <- cbind(heart,Age_dist)
heart
Age_dist <- cut(heart$Age, breaks = c(0,40,60,80), labels = c("(0-40]","(40,60]","(60,80]"))
heart <- read.csv("heart.csv",sep=",")
heart <- cbind(heart,Age_dist)
heart
summary(heart)
heart$Age <- as.numeric(heart$Age)
heart$Sex <- as.factor(heart$Sex)
heart$ChestPainType <- as.factor(heart$ChestPainType)
heart$RestingBP <- as.numeric(heart$RestingBP)
heart$Cholesterol <- as.numeric(heart$Cholesterol)
heart$FastingBS <- as.numeric(heart$FastingBS)
heart$RestingECG  <- as.factor(heart$RestingECG)
heart$MaxHR <- as.numeric(heart$MaxHR)
heart$ExerciseAngina <- as.factor(heart$ExerciseAngina)
heart$ST_Slope <- as.factor(heart$ST_Slope)
heart$HeartDisease <- as.numeric(heart$HeartDisease)
summary(heart)
str(heart)
qqnorm(heart$Sex)
qqnorm(as.character(heart$Sex))
as.character(heart$Sex)
qqnorm(as.character(heart$Sex))
qqnorm(heart$Sex)
qqnorm(heart$Age)
qqline(heart$Age)
shapiro.test(heart$Age)
lille.test(heart$Age)
lillie.test(heart$Age)
library(nortest)
install.packages(nortest)
install.packages("nortest")
library(nortest)
lillie.test(heart$Age)
str(heart)
qqnorm(heart$RestingBP)
qqline(heart$RestingBP)
shapiro.test(heart$RestingBP)
qqnorm(heart$Cholesterol)
qqline(heart$Cholesterol)
table(heart$FastingBS)
Age_nor <- (2*(heart$Age-min(heart$Age))/(max(heart$Age)-min(heart$Age)))-1
heart <- cbind(heart,Age_nor)
str(heart)
qqnorm(heart$MaxHR)
qqline(heart$MaxHR)
shapiro.test(heart$MaxHR)
lillie.test(heart$MaxHR)
qqnorm(heart$Oldpeak)
qqline(heart$Oldpeak)
qqnorm(heart$Age_nor)
qqline(heart$Age_nor)
shapiro.test(heart$Age_nor)
lillie.test(heart$Age_nor)
lillie.test(heart$Age)
heart$Cholesterol[heart$Sex=="M"]
colHom <- heart$Cholesterol[heart$Sex=="M"]
colMuj <- heart$Cholesterol[heart$Sex=="F"]
var.test(colHom,colMuj)
t.test( colHom, colMuj, var.equal=FALSE, alternative = "greater")
t.test( colMuj,colHom , var.equal=FALSE, alternative = "greater")
var.test(colMuj, colHom)
heart$HeartDisease[heart$Sex=="M" & heart$HeartDisease=="1"]
carHom <- heart$HeartDisease[heart$Sex=="M" & heart$HeartDisease=="1"]
carMuj <- heart$HeartDisease[heart$Sex=="F" & heart$HeartDisease=="1"]
var.test(carHom, carMuj)
var.test(carMuj,carHom)
heart$HeartDisease[heart$Sex=="F" & heart$HeartDisease=="1"]
heart$HeartDisease[heart$Sex=="M" & heart$HeartDisease=="1"]
carHom <- heart$FastingBS[heart$Sex=="M" & heart$HeartDisease=="1"]
carMuj <- heart$FastingBS[heart$Sex=="F" & heart$HeartDisease=="1"]
var.test(carMuj,carHom)
var.test(carHom,carMuj)
var.test(carMuj,carHom)
t.test( carHom,carMuj , var.equal=TRUE, alternative = "greater")
t.test( carMuj,carHom , var.equal=TRUE, alternative = "greater")
t.test( carHom,carMuj , var.equal=TRUE, alternative = "greater")
cor(heart,method="pearson")
heart
heart$ChestPainType <- as.numeric(heart$ChestPainType)
heart$ChestPainType
heart <- read.csv("heart.csv",sep=",")
heart$Age <- as.numeric(heart$Age)
heart$Sex <- as.factor(heart$Sex)
heart$ChestPainType <- as.factor(heart$ChestPainType)
heart$RestingBP <- as.numeric(heart$RestingBP)
heart$Cholesterol <- as.numeric(heart$Cholesterol)
heart$FastingBS <- as.numeric(heart$FastingBS)
heart$RestingECG  <- as.factor(heart$RestingECG)
heart$MaxHR <- as.numeric(heart$MaxHR)
heart$ExerciseAngina <- as.factor(heart$ExerciseAngina)
heart$ST_Slope <- as.factor(heart$ST_Slope)
heart$HeartDisease <- as.numeric(heart$HeartDisease)
summary(heart)
heart_num <-heart
heart_num <-heart
heart_num$Sex <- as.numeric(heart_num$Sex)
heart_num$ChestPainType <- as.numeric(heart_num$ChestPainType)
heart_num$RestingECG <- as.numeric(heart_num$RestingECG)
heart_num$ExerciseAngina <- as.numeric(heart_num$ExerciseAngina)
heart_num$ST_Slope <- as.numeric(heart_num$ST_Slope)
summary(heart_num)
cor(heart,method="pearson")
cor(heart_num,method="pearson")
corPlot(heart_num,method="pearson")
library(psych)
corPlot(heart_num,method="pearson")
heart <- read.csv("heart.csv",sep=",")
heart$Age <- as.numeric(heart$Age)
heart$Sex <- as.factor(heart$Sex)
heart$ChestPainType <- as.factor(heart$ChestPainType)
heart$RestingBP <- as.numeric(heart$RestingBP)
heart$Cholesterol <- as.numeric(heart$Cholesterol)
heart$FastingBS <- as.numeric(heart$FastingBS)
heart$RestingECG  <- as.factor(heart$RestingECG)
heart$MaxHR <- as.numeric(heart$MaxHR)
heart$ExerciseAngina <- as.factor(heart$ExerciseAngina)
heart$ST_Slope <- as.factor(heart$ST_Slope)
heart$HeartDisease <- as.numeric(heart$HeartDisease)
Age_nor <- (2*(heart$Age-min(heart$Age))/(max(heart$Age)-min(heart$Age)))-1
heart <- cbind(heart,Age_nor)
Age_dist <- cut(heart$Age, breaks = c(0,40,60,80), labels = c("(0-40]","(40,60]","(60,80]"))
heart <- cbind(heart,Age_dist)
heart
heart[1:12]
corPlot(heart_num, scale = FALSE)
Corelacion <- cor(heart_num)
Corelacion
library(psych)
corPlot(Corelacion, scale = FALSE)
library(psych)
corrplot(Corelacion, scale = FALSE)
if (!require('corrplot')) install.packages('corrplot'); library('corrplot')
corrplot(Corelacion, scale = FALSE)
if (!require('corrplot')) install.packages('corrplot'); library('corrplot')
corrplot(Corelacion, method = "number")
lm(Cholesterol~Age,data=heart)
model <- lm(Cholesterol~Age,data=heart)
summary(model)
summarY(heart)
summarY(heart)
summary(heart)
summary(lm(Cholesterol~RestingBP,data=heart))
summary(lm(Cholesterol~ChestPainType,data=heart))
summary(lm(Cholesterol~MaxHR,data=heart))
summary(lm(MaxHR~Age_nor,data=heart))
summary(lm(Cholesterol~Age_nor,data=heart))
summary(lm(MaxHR~Age_nor,data=heart))
summary(lm(HeartDisease~ST_Slope,data=heart))
summary(lm(HeartDisease~ST_Slope+oldpeak,data=heart))
summary(lm(HeartDisease~ST_Slope+Oldpeak,data=heart))
summary(lm(HeartDisease~ST_Slope+Oldpeak+MaxHR,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease+ChestPainType,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+Cholesterol,data=heart))
summary(lm(Cholesterol~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+MaxHR,data=heart))
summary(lm(Cholesterol~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+MaxHR+fASTINGbs,data=heart))
summary(lm(Cholesterol~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+MaxHR+FastingBS,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+MaxHR+FastingBS,data=heart))
summary(lm(MaxHR~ST_Slope+Oldpeak+HeartDisease+ChestPainType+RestingECG+FastingBS,data=heart))
summary(lm(HeartDisease~MaxHR+ST_Slope+Oldpeak++ChestPainType+RestingECG+FastingBS,data=heart))
glm(formula=HeartDisease~ST_Slope,data=heart,family=binomial())
summary(glm(formula=HeartDisease~ST_Slope,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxH+ChestPainType,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType+Age,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType+Age_dist,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType+Age_nor,data=heart,family=binomial()))
summary(glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType+RestingBP,data=heart,family=binomial()))
glm(formula=HeartDisease~ChestPainType,data=heart,family=binomial())
summary(glm(formula=HeartDisease~ChestPainType,data=heart,family=binomial()))
model_logis1 <- glm(formula=HeartDisease~ChestPainType,data=heart,family=binomial())
summary(model_logis1)
hoslem.test(heart$HeartDisease,fitted(model_logis1))
if (!require('ResourceSelection')) install.packages('ResourceSelection'); library('ResourceSelection')
hoslem.test(heart$HeartDisease,fitted(model_logis1))
model_logis1 <- glm(formula=HeartDisease~MaxHR,data=heart,family=binomial())
summary(model_logis1)
hoslem.test(heart$HeartDisease,fitted(model_logis1))
model_logis2 <- glm(formula=HeartDisease~ST_Slope+Oldpeak+MaxHR+ChestPainType+RestingBP+Age_nor,data=heart,family=binomial())
summary(model_logis2)
hoslem.test(heart$HeartDisease,fitted(model_logis2))
summary(lm(MaxHR~Age_nor,data=heart))
summary(lm(Cholesterol~Age_nor,data=heart))
summary(lm(FastingBS~Age_nor,data=heart))
summary(lm(MaxHR~Cholesterolr,data=heart))
summary(lm(MaxHR~Cholesterol,data=heart))
summary(lm(MaxHR~Age,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS+Oldpeak,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+Oldpeak,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS+Oldpeak+RestingECG,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS+Oldpeak+RestingECG+Sex,data=heart))
summary(lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS+Oldpeak+RestingECG+Sex+Cholesterol,data=heart))
Model_reg_sim <- lm(MaxHR~Age,data=heart)
summary(Model_reg_sim)
Model_reg_mul <- lm(MaxHR~Age+HeartDisease+ST_Slope+FastingBS+Oldpeak+RestingECG+Sex+Cholesterol,data=heart)
summary(Model_reg_mul)
modelo_trials <- C50::C5.0(trainx, trainy, trials = 10, rules = TRUE)
heart <- read.csv("heart.csv",sep=",")
prcomp(heart, center = TRUE, scale = TRUE)
str(heart)
prcomp(heart, scale = TRUE)
rescale(Adult$Age,c(-1,1))
as.numeric(Adult$Sex)
as.numeric(heart$Sex)
heart
prcomp(heart[,c(1,4:6,7,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,10)], scale = TRUE)
prcomp(heart[,c(1,4:6)], scale = TRUE)
prcomp(heart[,c(1,7,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10)], scale = TRUE)
summary(heart)
str(heart)
prcomp(heart[,c(1,4:6,7,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,8,10)], scale = TRUE)
str(heart)
prcomp(heart[,c(1,4:6,7,8,10,12)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10,11)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10,12)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10,12)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,7,8,10)], scale = TRUE)
prcomp(heart[,c(1,4:6,8,10,12)], scale = TRUE)
str(heart)
plot(pca, type="l")
pca = prcomp(heart[,c(1,4:6,8,10,12)], scale = TRUE)
plot(pca, type="l")
summary(pca)
plot_prcomp(absent_work, variance_cap = 0.8, maxcat = 50L,
prcomp_args = list(scale. = TRUE), geom_label_args = list(),
title = NULL, ggtheme = theme_light(), theme_config = list(),
nrow = 2L, ncol = 2L, parallel = FALSE)
plot_prcomp(heart[,c(1,4:6,8,10,12)], variance_cap = 0.8, maxcat = 50L,
prcomp_args = list(scale. = TRUE), geom_label_args = list(),
title = NULL, ggtheme = theme_light(), theme_config = list(),
nrow = 2L, ncol = 2L, parallel = FALSE)
library("factoextra")
fviz_pca_var(pca,
col.var = "contrib", # color en funcón de la contribución.
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE
)
library("factoextra")
install.packages("factoextra")
library("factoextra")
fviz_pca_var(pca,
col.var = "contrib", # color en funcón de la contribución.
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE
)
plot_prcomp(heart, variance_cap = 0.8, maxcat = 50L,
prcomp_args = list(scale. = TRUE), geom_label_args = list(),
title = NULL, ggtheme = theme_light(), theme_config = list(),
nrow = 2L, ncol = 2L, parallel = FALSE)
as.numeric("klkl")
is.numeric("klkl")
str(heart)
heart_num <- heart
heart_num$Sex <- with(df2, ifelse(edad_discretizada == "M", 0,1))))
heart_num$Sex <- with(df2, ifelse(edad_discretizada == "M", 0,1))
heart_num$Sex <- with(heart_num, ifelse(edad_discretizada == "M", 0,1))
heart_num$Sex <- with(heart_num, ifelse(Sex == "M", 0,1))
str(heart_num)
heart$ChestPainType
table(heart$ChestPainType)
heart_num$ChestPainType <- with(heart_num, ifelse(ChestPainType == "ASY",0,ifelse(ChestPainType == "ATA",1,ifelse(ChestPainType == "NAP",2,3))))
str(heart)
str(heart_num)
table(heart_num$RestingECG)
heart$RestingECG <- with(heart_num, ifelse(RestingECG == "LVH",0,ifelse(RestingECG == "Normal",1,2)))
str(heart_num)
str(heart_num)
heart <- read.csv("heart.csv",sep=",")
heart_num <- heart
heart_num$Sex <- with(heart_num, ifelse(Sex == "M", 0,1))
heart_num$ChestPainType <- with(heart_num, ifelse(ChestPainType == "ASY",0,ifelse(ChestPainType == "ATA",1,ifelse(ChestPainType == "NAP",2,3))))
heart_num$RestingECG <- with(heart_num, ifelse(RestingECG == "LVH",0,ifelse(RestingECG == "Normal",1,2)))
str(heart_num)
table(heart_num$ExerciseAngina)
heart_num$ExerciseAngina <- with(heart_num, ifelse(ExerciseAngina == "N", 0,1))
str(heart_num)
table(heart_num$ST_Slope)
heart_num$ST_Slope <- with(heart_num, ifelse(ST_Slope == "Down", 0,ifelse(ST_Slope == "Flat",1,2)))
fviz_contrib(pca, addlabels = TRUE, choice = "var", axes = 1, top = 20)
